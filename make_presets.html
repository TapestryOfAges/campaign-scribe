<html>
<head>
<title>Make presets for turntracker</title>
        <link rel="stylesheet" type="text/css" href="jqModal.css" />
        <script language="JavaScript" src="jquery-1.3.2.js"></script>
  <script language="JavaScript" src="jqModal.js"></script>
  <script language="JavaScript" src="icons/icons.js"></script>
  <script language="JavaScript">

var presets = new Array;
var groupname = "";

function pickIcon() {
  var icontable = '<table cellpadding="3" cellspacing="0" border="0">';
  for (i=0;i < iconlist.length; i++) {
    icontable = icontable + "<tr>";
    for (j=0;j < 12; j++) {
      if (i+j < iconlist.length) {
        var icon = iconlist[i+j];
        icontable = icontable + "<td onClick='select_icon(\"" + icon + "\")'><img src='icons/" + icon + "'  width='32' height='32' /></td>";
      }
    }
    i += 11;
    icontable = icontable + "</tr>";
  }
  icontable = icontable + "</table>";
  document.getElementById('icontd').innerHTML = icontable;
}

function select_icon(new_icon) {
  if (!chooseGroupIcon) {
        var the_form=document.add_manually;
        the_form.com_icon.value = new_icon;
        document.getElementById('com_icon_pic').src = "icons/" + new_icon;
        document.getElementById('icontd').innerHTML = "";
  } else {
    groupIcon = new_icon;
    chooseGroupIcon = 0;
    document.getElementById("groupicon").innerHTML = "<img src='icons/" + new_icon + "' width='32' />";
  }
}

function submitAddPreset() {
  var the_form = document.add_manually;
  var name = the_form.com_name.value;
  the_form.com_name.value ="";
  var align;
  for (i=0; i < the_form.com_align.length; i++) {
    if (the_form.com_align.options[i].selected) {
      align = the_form.com_align.options[i].value;
    }
  }

  var initmod = the_form.com_initmod.value;
  the_form.com_initmod.value = "";
  var icon = the_form.com_icon.value;

  var index = presets.length;
  if (groupname == "") {
    groupname = prompt("Name of group:", groupname);
    if (!groupname) { groupname = "default"; }
  }
  
  group = groupname + "[" + index + "]";
  var code = group + " = new Entity;<br />";
  code = code + "" + group + ".name = '" + name + "';<br />";
  code = code + "" + group + ".initmod = " + initmod + ";<br />";
  code = code + "" + group + ".align = '" + align + "';<br />";
  code = code + "" + group + ".icon = '" + icon + "';<br />";
  code = code + "<br />";

  presets[index] = code;

}

function submitPrintPresets() {
  let code = "presets." + groupname + " = {};<br />";
  code = code + "presets." + groupname + ".icon = '" + groupIcon + "'; <br /><br />";
  code = code + "let " + groupname + " = [];<br /><br />";
  for (i=0;i<presets.length;i++) {
    code = code + presets[i];
  }
  code = code + 'presets["'+ groupname +'"].data = ' + groupname + ';<br /><br />';
  document.getElementById('print_results').innerHTML = code;
}

let groupIcon = null;
let chooseGroupIcon = null;
function submitChooseIcon() {
  chooseGroupIcon = 1;
  pickIcon();
}

</script>
</head>
<body>
       <div id="addmanual">
         <div id="groupicon"></div>
                <form name="add_manually">
                        <table cellpadding="0" cellspacing="0" border="0"><tr><td>
                        <p>Enter combatant values:<br/>
                        Name: <input type="text" name="com_name" size="15" /><br />
                        Align: <select name="com_align"><option value="friendly">Friendly</option><option value="enemy">Enemy</option>
                                                            <option value="neutral">Neutral</option></select><br />
                  Initmod: <input type="text" name="com_initmod" size="2" /><br />
                  Icon: <img src="icons/red_skull.gif" width="32" height="32" id="com_icon_pic" onClick="pickIcon();" /><br />
                  <input type="hidden" value="red_skull.gif" name="com_icon" /></p>
                  </td>
                  <td id="icontd"></td></tr></table>
                  <p><input type="button" value="Add" onClick="submitAddPreset('add');" /> <input type="button" value="Print" onClick="submitPrintPresets()" /> <input type="button" value="Icon" onClick="submitChooseIcon()" /></p>
                  
                </form>
        </div>

   <div id="print_results">
   </div>

</body>
</html>
